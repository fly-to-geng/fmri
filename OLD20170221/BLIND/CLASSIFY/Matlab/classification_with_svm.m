%输入数据和是否做降维，输出准确率、临时准确率，模型参数
%praOpt表示是否做参数优化，1表示做，0表示不做
clear;clc;
data_path = 'D:\FMRI_ROOT\YANTAI\CLASSIFY\MVPA\20160907002\';
cd(data_path)
load data_Mask16.img.mat

a=data_STG(:,1);
% 四分类
%
% for i=1:768
%     if  a(i,1)==1||a(i,1)==2||a(i,1)==3||a(i,1)==4
%         a(i,1)=1;
%     elseif   a(i,1)==5||a(i,1)==6||a(i,1)==7||a(i,1)==8
%         a(i,1)=2;
%     elseif   a(i,1)==9||a(i,1)==10||a(i,1)==11||a(i,1)==12
%         a(i,1)=3;
%     elseif   a(i,1)==13||a(i,1)==14||a(i,1)==15||a(i,1)==16
%         a(i,1)=4;
%     end 
% end

% 二分类；有无噪声
for i=1:768
    if  a(i,1)==1||a(i,1)==3||a(i,1)==5||a(i,1)==7||a(i,1)==9||a(i,1)==11||a(i,1)==13||a(i,1)==15
        a(i,1)=1;
    elseif   a(i,1)==2||a(i,1)==4||a(i,1)==6||a(i,1)==8||a(i,1)==10||a(i,1)==12||a(i,1)==14||a(i,1)==16
        a(i,1)=2;
    end 
end


%二分类；声音方位
% for i=1:768
%     if  a(i,1)==1||a(i,1)==2||a(i,1)==5||a(i,1)==6||a(i,1)==9||a(i,1)==10||a(i,1)==13||a(i,1)==14
%         a(i,1)=1;
%     elseif   a(i,1)==3||a(i,1)==4||a(i,1)==7||a(i,1)==8||a(i,1)==11||a(i,1)==12||a(i,1)==15||a(i,1)==16
%         a(i,1)=2;
%     end 
% end

data_STG(:,1)=a;
temp_data = data_STG(1:768,:);
allData = randBeforeSVM(temp_data);

confmat=zeros(2,2);
acc = [ ];
        
for i = 1:2
    index = ones(768,1);
%     index(1 + (i - 1)) = 0;
    index((1:384) + 384 * (i-1)) = 0;
    trainIndex = index == 1;
    testIndex = index == 0;
    trainData = allData(trainIndex,:);
    testData = allData(testIndex,:);
    model = svmtrain(trainData(:,1),trainData(:,2:end), ' -q');
    [predictLabel,accuracy,xxx] = svmpredict(testData(:,1),testData(:,2:end),model,' -q' );
    disp(['====',num2str(accuracy(1)),'=====']);
    acc = [acc accuracy(1)];
end
accracy = mean(acc);
%=========================================================================
% subject 20160907002 | Mask | 四分类
%====58.0729=====
%====51.3021=====

%声音方位
%====65.8854=====
%====65.3646=====

%有无噪声
%====66.6667=====
%====64.3229=====

% subject 20160907002 | STG | 四分类
%====58.3333=====
%====57.2917=====

%声音方位
%====63.0208=====
%====65.8854=====

%有无噪声
%====65.625=====
%====64.5833=====

% subject 20160907002 | Mask16 | 四分类
%====57.0313=====
%====58.5938=====

%声音方位
%====72.6563=====
%====76.3021=====

%有无噪声
%====70.5729=====
%====66.9271=====
%==========================================================================
% subject 20160911002 | mask | 四分类
%====54.9479=====
%====58.5938=====
       
% 有无噪声
% ====67.9688=====
% ====64.3229=====

%声音方位
%====77.8646=====
%====73.4375=====

% subject 20160911002 | STG | 四分类
%====52.3438=====
%====51.5625=====

%有无噪音
%====65.625=====
%====63.8021=====

%声音方位
%====82.0313=====
%====79.6875=====

% subject 20160911002 | Mask16 | 四分类
%====63.8021=====
%====64.3229=====

%声音方位
%====82.0313=====
%====87.7604=====

%有无噪声
%====71.6146=====
%====72.6563=====

%==========================================================================
%subject 20160916001  | mask | 四分类
%====53.9063=====
%====54.4271=====

%声音方位
%====68.2292=====
%====69.7917=====

%有无噪音
%====63.0208=====
%====68.2292=====

%subject 20160916001  | STG | 四分类
%====52.6042=====
%====51.8229=====

%声音方位
%====67.1875=====
%====66.4063=====

%有无噪声
%====63.5417=====
%====62.7604=====

%subject 20160916001  | Mask16 | 四分类
%====63.0208=====
%====59.6354=====

%声音方位 二分类
%====77.3438=====
%====73.4375=====

%有无噪声
%====69.7917=====
%====70.0521=====